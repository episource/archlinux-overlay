<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

  <!--
  The system wide tracker service is run as root, so that all files can be
  indexed independent from file permissions. It's up to the consumer of the
  index to filter search results appropriately. To prevent data leaks, the
  system tracker may only be queried by root.
  -->
  
  <!-- Only user "root" can own the Tracker services -->
  <policy user="root">
    <allow own="org.freedesktop.Tracker1"/>
    <allow own="org.freedesktop.Tracker1.Miner.Files"/>
    <allow own="org.freedesktop.Tracker1.Miner.Files.Index"/>
    <allow own="org.freedesktop.Tracker1.Miner.Extract"/>
    <allow own="org.freedesktop.Tracker1.Writeback"/>
  </policy>

  <!-- Allow sending and receiving for root only, deny for others -->
  <policy context="default">
    <deny send_destination="org.freedesktop.Tracker1"/>
    <deny receive_sender="org.freedesktop.Tracker1"/>
     
    <deny send_destination="org.freedesktop.Tracker1.Miner.Files"/>
    <deny receive_sender="org.freedesktop.Tracker1.Miner.Files"/>
     
    <deny send_destination="org.freedesktop.Tracker1.Miner.Files.Index"/>
    <deny receive_sender="org.freedesktop.Tracker1.Miner.Files.Index"/>
     
    <deny send_destination="org.freedesktop.Tracker1.Miner.Extract"/>
    <deny receive_sender="org.freedesktop.Tracker1.Miner.Extract"/>
     
    <deny send_destination="org.freedesktop.Tracker1.Writeback"/>
    <deny receive_sender="org.freedesktop.Tracker1.Writeback"/>
  </policy>
  <policy user="root">
    <allow send_destination="org.freedesktop.Tracker1"/>
    <allow receive_sender="org.freedesktop.Tracker1"/>
  
    <allow send_destination="org.freedesktop.Tracker1.Miner.Files"/>
    <allow receive_sender="org.freedesktop.Tracker1.Miner.Files"/>
    
    <allow send_destination="org.freedesktop.Tracker1.Miner.Files.Index"/>
    <allow receive_sender="org.freedesktop.Tracker1.Miner.Files.Index"/>
    
    <allow send_destination="org.freedesktop.Tracker1.Miner.Extract"/>
    <allow receive_sender="org.freedesktop.Tracker1.Miner.Extract"/>
    
    <allow send_destination="org.freedesktop.Tracker1.Writeback"/>
    <allow receive_sender="org.freedesktop.Tracker1.Writeback"/>
  </policy>

</busconfig>